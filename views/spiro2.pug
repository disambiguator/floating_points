doctype html
html(lang='en')
  include includes/head.pug
  script#vertexshader(type="x-shader/x-vertex").
    #ifdef GL_ES
    precision highp float;
    #endif

    uniform float amplitude;
    attribute float displacement;
    varying vec3 vNormal;

    void main() {

    vNormal = normal;

      // multiply our displacement by the
      // amplitude. The amp will get animated
      // so we'll have animated displacement
      vec3 newPosition = position +
        vec3(displacement *
        amplitude);

    gl_Position = projectionMatrix *
      modelViewMatrix *
      vec4(newPosition,1.0);
    }
  script#fragmentshader(type="x-shader/x-fragment").
    #ifdef GL_ES
    precision highp float;
    #endif

    // same name and type as VS
    varying vec3 vNormal;

    void main() {

      // calc the dot product and clamp
      // 0 -> 1 rather than -1 -> 1
      vec3 light = vec3(0.5,0.2,1.0);

      // ensure it's normalized
    light = normalize(light);

      float dProd = max(0.0, dot(vNormal, light));

      // feed into our frag colour
    gl_FragColor = vec4(1.0);

    }
  body
    label Amplitude
    input(type='range', min='-5', max='5', step='0.1', oninput='amplitudeSlider(this)')
    div#spiro
    script(type='text/javascript', src='dist/main.js')
